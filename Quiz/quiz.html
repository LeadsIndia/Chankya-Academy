<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Indian Geography Quiz (Randomized)</title>
</head>
<body>
  <h1>Indian Geography Quiz (Randomized)</h1>
  <button onclick="generateQuiz()">New Quiz</button>
  <form id="quizForm"></form>
  <button onclick="submitQuiz()">Submit</button>
  <div id="result"></div>

  <script>
    // Sample data: Replace with your full 500-question array
    const allQuestions = [
      // North India (Sample)
      {region: "North India", question: "Q1 North", options: ["A","B","C","D"], answer: "A"},
      {region: "North India", question: "Q2 North", options: ["A","B","C","D"], answer: "B"},
      {region: "North India", question: "Q3 North", options: ["A","B","C","D"], answer: "C"},
      {region: "North India", question: "Q4 North", options: ["A","B","C","D"], answer: "D"},
      {region: "North India", question: "Q5 North", options: ["A","B","C","D"], answer: "A"},
      // South India (Sample)
      {region: "South India", question: "Q1 South", options: ["A","B","C","D"], answer: "A"},
      {region: "South India", question: "Q2 South", options: ["A","B","C","D"], answer: "B"},
      {region: "South India", question: "Q3 South", options: ["A","B","C","D"], answer: "C"},
      {region: "South India", question: "Q4 South", options: ["A","B","C","D"], answer: "D"},
      {region: "South India", question: "Q5 South", options: ["A","B","C","D"], answer: "A"},
      // East India (Sample)
      {region: "East India", question: "Q1 East", options: ["A","B","C","D"], answer: "A"},
      {region: "East India", question: "Q2 East", options: ["A","B","C","D"], answer: "B"},
      {region: "East India", question: "Q3 East", options: ["A","B","C","D"], answer: "C"},
      {region: "East India", question: "Q4 East", options: ["A","B","C","D"], answer: "D"},
      {region: "East India", question: "Q5 East", options: ["A","B","C","D"], answer: "A"},
      // West India (Sample)
      {region: "West India", question: "Q1 West", options: ["A","B","C","D"], answer: "A"},
      {region: "West India", question: "Q2 West", options: ["A","B","C","D"], answer: "B"},
      {region: "West India", question: "Q3 West", options: ["A","B","C","D"], answer: "C"},
      {region: "West India", question: "Q4 West", options: ["A","B","C","D"], answer: "D"},
      {region: "West India", question: "Q5 West", options: ["A","B","C","D"], answer: "A"},
      // Central India (Sample)
      {region: "Central India", question: "Q1 Central", options: ["A","B","C","D"], answer: "A"},
      {region: "Central India", question: "Q2 Central", options: ["A","B","C","D"], answer: "B"},
      {region: "Central India", question: "Q3 Central", options: ["A","B","C","D"], answer: "C"},
      {region: "Central India", question: "Q4 Central", options: ["A","B","C","D"], answer: "D"},
      {region: "Central India", question: "Q5 Central", options: ["A","B","C","D"], answer: "A"},
      // Northeast India (Sample)
      {region: "Northeast India", question: "Q1 NE", options: ["A","B","C","D"], answer: "A"},
      {region: "Northeast India", question: "Q2 NE", options: ["A","B","C","D"], answer: "B"},
      {region: "Northeast India", question: "Q3 NE", options: ["A","B","C","D"], answer: "C"},
      {region: "Northeast India", question: "Q4 NE", options: ["A","B","C","D"], answer: "D"},
      {region: "Northeast India", question: "Q5 NE", options: ["A","B","C","D"], answer: "A"}
    ];

    // Group questions by region
    const regions = ["North India", "South India", "East India", "West India", "Central India", "Northeast India"];
    let questionsByRegion = {};
    regions.forEach(region => {
      questionsByRegion[region] = allQuestions.filter(q => q.region === region);
    });

    let previousQuiz = [];

    // Utility: Shuffle an array
    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    // Select 4 random questions per region, avoiding repeats from previousQuiz
    function selectQuiz() {
      let newQuiz = [];
      let repeats = 0;
      let previousSet = new Set(previousQuiz.map(q => q.question));
      regions.forEach(region => {
        let regionQuestions = questionsByRegion[region].slice(); // clone
        shuffle(regionQuestions);

        // Try to select 4 questions with minimal repeats
        let selected = [];
        for (let q of regionQuestions) {
          if (selected.length < 4) {
            if (!previousSet.has(q.question) || repeats >=
